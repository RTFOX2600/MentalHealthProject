{% extends 'base.html' %}
{% load static %}

{% block title %}关于我们 - 精准思政系统{% endblock %}

{% block content_wrapper %}
<link rel="stylesheet" href="{% static 'css/about.css' %}">
<div class="about-page-container">
    <!-- 顶部横幅 -->
    <div class="hero-banner fade-in-up" style="animation-delay: 0.1s;">
        <h1 style="font-size: 3rem; font-weight: 900; margin-bottom: 1.5rem; color: white;">精准思政系统</h1>
        <p style="font-size: 1.35rem; opacity: 0.95; max-width: 750px; line-height: 1.6; color: white;">
            融合大数据分析与心理健康评估，为武汉轻工大学提供精准的思想引导、思政辅助与舆情监控支持。
        </p>
    </div>

    <!-- 技术栈部分 -->
    <div class="section-title fade-in-up" style="animation-delay: 0.2s;">
        <div class="dot"></div>
        <h2>项目技术栈</h2>
    </div>
    <div class="grid-container">
        <div class="fade-in-up" style="animation-delay: 0.25s;">
            <div class="tech-card" style="border-top: 5px solid var(--python-color);">
                <h4>Python 3.12</h4>
                <p>项目核心开发语言，凭借其丰富的第三方库生态，驱动系统内所有复杂的数据处理、分析逻辑与 AI 算法实现。</p>
            </div>
        </div>
        <div class="fade-in-up" style="animation-delay: 0.3s;">
            <div class="tech-card" style="border-top: 5px solid var(--pandas-sklearn-color);">
                <h4>pandas & scikit-learn</h4>
                <p>数据科学双引擎，负责海量校园行为数据的清洗、特征提取以及心理健康预测模型的训练与评估。</p>
            </div>
        </div>
        <div class="fade-in-up" style="animation-delay: 0.35s;">
            <div class="tech-card" style="border-top: 5px solid var(--django-color);">
                <h4>Django</h4>
                <p>全能型 Web 框架，提供稳健的安全机制、ORM 管理与高效的开发流程。</p>
            </div>
        </div>
        <div class="fade-in-up" style="animation-delay: 0.4s;">
            <div class="tech-card" style="border-top: 5px solid var(--deepseek-color);">
                <h4 class="unused">DeepSeek</h4>
                <p>AI 辅导员与舆论分析引擎，负责在线心理服务与舆论监控关键信息总结。</p>
            </div>
        </div>
        <div class="fade-in-up" style="animation-delay: 0.45s;">
            <div class="tech-card" style="border-top: 5px solid var(--redis-celery-color);">
                <h4>Redis & Celery</h4>
                <p>高性能任务队列与缓存系统，支撑海量校园行为数据的异步处理与实时分析。</p>
            </div>
        </div>
        <div class="fade-in-up" style="animation-delay: 0.5s;">
            <div class="tech-card" style="border-top: 5px solid var(--postgresql-color);">
                <h4 class="unused">PostgreSQL</h4>
                <p>工业级数据底座，保障海量校园行为数据的高并发读取与持久化存储。</p>
            </div>
        </div>
        <div class="fade-in-up" style="animation-delay: 0.55s;">
            <div class="tech-card" style="border-top: 5px solid var(--crawler-color);">
                <h4 class="unused">网络爬虫</h4>
                <p>自动化舆论监控抓取，实时获取校园相关的多源社交媒体与新闻动态数据。</p>
            </div>
        </div>
        <div class="fade-in-up" style="animation-delay: 0.6s;">
            <div class="tech-card" style="border-top: 5px solid var(--bootstrap-color);">
                <h4>Bootstrap</h4>
                <p>现代响应式 UI，确保系统在 PC、平板与手机端均有极致的视觉表现。</p>
            </div>
        </div>
        <div class="fade-in-up" style="animation-delay: 0.65s;">
            <div class="tech-card" style="border-top: 5px solid var(--chartjs-color);">
                <h4 class="unused">Chart.js</h4>
                <p>动态数据可视化，将抽象的思想状态分析结果转化为直观的图表报告。</p>
            </div>
        </div>
        <div class="fade-in-up" style="animation-delay: 0.7s;">
            <div class="tech-card" style="border-top: 5px solid var(--datatables-color);">
                <h4 class="unused">DataTables</h4>
                <p>专业级数据展示，提供极致的表格排序、全局搜索与即时统计功能。</p>
            </div>
        </div>
        <div class="fade-in-up" style="animation-delay: 0.75s;">
            <div class="tech-card" style="border-top: 5px solid var(--docker-color);">
                <h4>Docker</h4>
                <p>容器化部署方案，确保系统在生产环境下的高度一致性与秒级弹性伸缩。</p>
            </div>
        </div>
    </div>

    <!-- 团队部分 -->
    <div class="section-title fade-in-up" style="animation-delay: 0.1s;">
        <div class="dot"></div>
        <h2>项目团队</h2>
    </div>
    <div class="team-container">
        <div class="fade-in-up" style="animation-delay: 0.15s;">
            <div class="member-card">
                <div>
                    <span class="role-badge">Project Author</span>
                    <span class="member-name" style="color: var(--primary-color);">史天润 & 申卓毅</span>
                    <p class="member-desc">
                        负责系统从 0 到 1 的全栈架构设计，涵盖大数据接入、分析模型训练以及用户交互界面的深度打磨。
                    </p>
                </div>
            </div>
        </div>
        <div class="fade-in-up" style="animation-delay: 0.2s;">
            <div class="member-card">
                <div>
                    <span class="role-badge">Mentor</span>
                    <span class="member-name" style="color: var(--success-color);">舒亦雄 老师</span>
                    <p class="member-desc">
                        提供项目方向指导及业务逻辑校准，确保系统在教育管理实务中的有效落地。
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- 联系方式部分 -->
    <div class="section-title fade-in-up" style="margin-top: 5rem; animation-delay: 0.25s;">
        <div class="dot"></div>
        <h2>联系方式</h2>
    </div>
    <div class="contact-container">
        <div class="fade-in-up" style="animation-delay: 0.3s;">
            <div class="contact-card" style="border-left: 5px solid var(--primary-color);">
                <h4>系统管理员</h4>
                <p>如有任何系统故障或数据异常，请及时与管理员取得联系。</p>
                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                    <p>
                        <strong>史天润：</strong>
                        <a class="external-link" href="mailto:2652205627@qq.com">2652205627@qq.com</a>
                    </p>
                    <p>
                        <strong>申卓毅：</strong>
                        <a class="external-link" href="mailto:1578093978@qq.com">1578093978@qq.com</a>
                    </p>
                </div>
                <h4>指导老师</h4>
                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                    <p>
                        <strong>舒亦雄：</strong>
                        <a class="external-link" href="mailto:852085570@qq.com">852085570@qq.com</a>
                    </p>
                </div>
            </div>
        </div>
        <div class="fade-in-up" style="animation-delay: 0.35s;">
            <div class="contact-card" style="border-left: 5px solid #10b981;">
                <h4 style="color: var(--success-color);">学校资源</h4>
                <div style="margin-top: 0.5rem;">
                    <p style="color: var(--success-color);">
                        <strong>学校官网：</strong>
                        <a class="external-link" href="https://www.whpu.edu.cn/" target="_blank">https://www.whpu.edu.cn/</a>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- 项目许可证部分 -->
    <div class="section-title fade-in-up" style="margin-top: 5rem; animation-delay: 0.1s;">
        <div class="dot"></div>
        <h2>项目许可证</h2>
    </div>
    <div class="contact-container">
        <div class="fade-in-up" style="animation-delay: 0.15s;">
            <div class="contact-card" style="border-left: 5px solid var(--success-color);">
                <h4 style="color: var(--success-color);">GNU AGPL-3.0 License</h4>
                <p style="margin-top: 0.5rem; margin-bottom: 0; color: var(--muted-text); line-height: 1.8;">
                    本项目采用 <strong>GNU Affero General Public License v3.0</strong> 开源许可证，这是一个强 Copyleft 许可证，保障所有用户的自由权利：
                </p>
                <ul style="color: var(--muted-text); line-height: 1.8; margin-bottom: 0; padding-left: 1.5rem;">
                    <li><strong>自由使用：</strong>任何人都可以免费使用本系统，无需支付授权费用。</li>
                    <li><strong>自由修改：</strong>可以查看完整源代码并根据需求进行修改、改进或定制。</li>
                    <li><strong>自由分发：</strong>可以将原版或修改后的版本分享给他人，但必须保持相同许可证。</li>
                    <li><strong>网络服务义务：</strong>如果通过网络提供服务（如 Web 应用），必须向用户提供源代码。</li>
                </ul>
                <p style="color: var(--muted-text); font-size: 0.9rem; margin-bottom: 1rem; line-height: 1.6; display: flex; align-items: flex-start; gap: 0.5rem;">
                    <span class="icon" style="-webkit-mask-image: url('{% static 'icons/alert-triangle.svg' %}'); mask-image: url('{% static 'icons/alert-triangle.svg' %}'); flex-shrink: 0; margin-top: 0.2rem; margin-right: 0;"></span>
                    <span><strong>本许可证要求所有衍生作品（包括修改版本）也必须以 AGPL-3.0 开源，不允许闭源商业化。</strong></span>
                </p>
                <a href="{% static 'downloads/certificates/AGPL-3.0-LICENSE.txt' %}" class="btn btn-primary" style="display: inline-flex; align-items: center; gap: 0.5rem;" download>
                    <img src="{% static 'icons/download.svg' %}" alt="下载" width="18" height="18" style="filter: brightness(0) invert(1);">
                    下载完整许可证文本
                </a>
            </div>
        </div>
    </div>

    <!-- 开源仓库部分 -->
    <div class="section-title fade-in-up" style="margin-top: 5rem; animation-delay: 0.1s;">
        <div class="dot"></div>
        <h2>开源仓库</h2>
    </div>
    <div class="contact-container">
        <div class="fade-in-up" style="animation-delay: 0.15s;">
            <div class="contact-card" style="border-left: 5px solid var(--primary-color);">
                <h4 style="color: var(--primary-color);">GitHub 项目仓库</h4>
                <p style="margin-top: 0.5rem; margin-bottom: 1rem; color: var(--muted-text); line-height: 1.8;">
                    本项目完全开源，欢迎访问 GitHub 仓库查看源代码、提交 Issue 或参与贡献。项目遵循 AGPL-3.0 开源许可证。
                </p>
                <a href="https://github.com/RTFOX2600/MentalHealthProject" target="_blank" rel="noopener noreferrer" class="btn btn-primary" style="display: inline-flex; align-items: center; gap: 0.5rem;">
                    <span class="icon" style="-webkit-mask-image: url('{% static 'icons/github.svg' %}'); mask-image: url('{% static 'icons/github.svg' %}'); background-color: white; margin-right: 0;"></span>
                    访问 GitHub 仓库
                </a>
            </div>
        </div>
    </div>

    <!-- 其它资源部分 -->
    <div class="section-title fade-in-up" style="margin-top: 5rem; animation-delay: 0.1s;">
        <div class="dot"></div>
        <h2>其它资源</h2>
    </div>
    <div class="contact-container">
        <div class="fade-in-up" style="animation-delay: 0.2s;">
            <div class="contact-card" style="border-left: 5px solid var(--info-color);">
                <h4 style="color: var(--info-color);">班级宿舍分配系统</h4>
                <p style="margin-top: 0.5rem; margin-bottom: 1rem; color: var(--muted-text);">
                    基于遗传算法的智能宿舍分配系统，自动综合考虑班级、性别、住宿偏好等多维约束，生成分配方案。（仅适用于 2025 级的调查问卷）
                </p>
                <a href="{% static 'downloads/ez-allocation Setup 1.0.0.exe' %}" class="btn btn-primary" style="display: inline-flex; align-items: center; gap: 0.5rem;" download>
                    <img src="{% static 'icons/download.svg' %}" alt="下载" width="18" height="18" style="filter: brightness(0) invert(1);">
                    下载安装包
                </a>
            </div>
        </div>
        <div class="fade-in-up" style="animation-delay: 0.3s;">
            <div class="contact-card" style="border-left: 5px solid var(--success-color);">
                <h4 style="color: var(--success-color);">测试数据表格</h4>
                <p style="margin-top: 0.5rem; margin-bottom: 1rem; color: var(--muted-text);">
                    精准思政系统测试表格集，包含食堂消费、校门进出、宿舍门禁、网络访问和成绩记录等样例数据。
                </p>
                <button onclick="downloadTestTables()" class="btn btn-primary" style="display: inline-flex; align-items: center; gap: 0.5rem;">
                    <img src="{% static 'icons/download.svg' %}" alt="下载" width="18" height="18" style="filter: brightness(0) invert(1);">
                    <span id="download-text">下载所有表格</span>
                </button>
            </div>
        </div>
    </div>
</div>

<script>
async function downloadTestTables() {
    // 定义需要下载的文件列表（使用实际文件名）
    const files = [
        { name: '01_食堂消费月度表.csv', path: "{% static 'downloads/test_tables/01_食堂消费月度表.csv' %}" },
        { name: '02_校门进出记录表.csv', path: "{% static 'downloads/test_tables/02_校门进出记录表.csv' %}" },
        { name: '03_寝室门禁记录表.csv', path: "{% static 'downloads/test_tables/03_寝室门禁记录表.csv' %}" },
        { name: '04_网络访问记录表.csv', path: "{% static 'downloads/test_tables/04_网络访问记录表.csv' %}" },
        { name: '05_各科成绩表.csv', path: "{% static 'downloads/test_tables/05_各科成绩表.csv' %}" }
    ];
    
    const downloadText = document.getElementById('download-text');
    const originalText = downloadText.textContent;
    const btn = downloadText.closest('button');
    
    // 禁用按钮防止重复点击
    btn.disabled = true;
    
    try {
        for (let i = 0; i < files.length; i++) {
            const file = files[i];
            downloadText.textContent = `正在下载 (${i + 1}/${files.length})`;
            
            // 使用 fetch 下载文件，确保一个完成后再开始下一个
            const response = await fetch(file.path);
            if (!response.ok) throw new Error(`下载失败: ${file.name}`);
            
            const blob = await response.blob();
            const url = window.URL.createObjectURL(blob);
            
            // 触发浏览器保存
            const a = document.createElement('a');
            a.href = url;
            a.download = file.name;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            
            // 释放 URL 对象
            window.URL.revokeObjectURL(url);
            
            // 每个文件之间稍微停顿，确保浏览器处理顺滑
            await new Promise(resolve => setTimeout(resolve, 600));
        }
    } catch (error) {
        console.error('下载过程中出错:', error);
    } finally {
        setTimeout(() => {
            downloadText.textContent = originalText;
            btn.disabled = false;
        }, 1000);
    }
}
</script>
{% endblock %}
